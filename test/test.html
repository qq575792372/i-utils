<!doctype html>
<html lang="zh">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>测试开发环境源码</title>
  <style></style>
</head>
<body>
</body>

<!-- 使用module模式对源码进行测试，用webstorm启动服务 -->
<script type="module">
  import * as iUtils from "../src/index.js";

  iUtils.loadedTest();

  // 统计function api的数量
  let num = 0;
  Object.keys(iUtils).forEach((key) => {
    // 是function api
    if (typeof iUtils[key] === "function" && key !== "loadedTest") {
      num++;
    }
    // 对象中包含function api，比如sm2，base64等加密算法的api
    if (typeof iUtils[key] === "object") {
      Object.keys(iUtils[key]).forEach(objKey => {
        if (typeof iUtils[key][objKey] === "function") {
          num++;
        }
      });
    }
  });
  console.log(`iUtils一共 ${num} 个api`, iUtils);

  let encryptData = iUtils.des.encrypt("hello! admin!你好啊，管理员", "mykeddddymykeddddymykeddddymykeddddymykeddddy");
  console.log(11, encryptData);
  let decryptData = iUtils.des.decrypt(encryptData, "mykeddddymykeddddymykeddddymykeddddymykeddddy");
  console.log(22, decryptData);

  // iUtils.setClipboardText("快来复制我吧").then(res => {
  //   console.log("复制结果：", res);
  // });

let file = await iUtils.urlToFile('https://dummyimage.com/300.png');
let blob = await iUtils.fileToBlob(file)
  console.log(2222,blob);
  let res = await iUtils.setClipboard(blob)
  console.log(111,res);

  setTimeout(async () => {
    // iUtils.getClipboardText().then(text => {
    //   console.log("获得文本1：", text);
    // });
    // let res = await iUtils.getClipboardText();
    // console.log("获得文本2：", res);

    let res1 = await iUtils.getClipboard();
    console.log("获得数据1", res1);
  }, 1000);

</script>
</html>
